<h1>Waivers for <%= @course.name %></h1>

<p id="notice"><%= notice %></p>

  <% if (User.find_by_id(@course.user_id)) != nil %>
    <b>Course Instructor:</b>
    <%= @course.user.email %>
  <% end %>
</p>

<table class="table">
  <tr>
    <th><%= sortable "created_at", "Timestamp" %></th>
    <th><%= sortable "first_name" %></th>
    <th><%= sortable "last_name" %></th>
    <th><%= sortable "email" %></th>
    <th><%= sortable "waiver_class" %></th>
    <th><%= sortable "replacement_class" %></th>
    <th><%= sortable "taken_replacement_class" %></th>
    <th><%= sortable "comments" %></th>
    <th><%= sortable "status" %></th>
    <th><%= sortable "documentation", "Attachments" %></th>
    <th></th>
    <th></th>
  </tr>

<% @course.waivers.order(sort_column + " " + sort_direction).each do |waiver| %>
  <tr>
    <td><%= waiver.created_at %></td>
    <td><%= waiver.first_name %></td>
    <td><%= waiver.last_name %></td>
    <td><%= waiver.email %></td>
    <td><%= waiver.course.name %></td>
    <td><%= waiver.replacement_class %></td>
    <td><%= waiver.taken_replacement_class %></td>
    <td><%= waiver.comments %></td>
    <td><%= waiver.status %></td>
    <td><%= link_to 'Attachment', waiver.documentation.url %></td>
    <td>
      <%= link_to 'Show', waiver %><br />
    
    <!-- Instructors do not have the ability to edit or delete waivers but the administrator does
      
      <% if admin_signed_in? %>
        <%= link_to 'Edit', edit_waiver_path(waiver) %><br />
        <%= link_to 'Delete', waiver, method: :delete, data: { confirm: 'Are you sure?' } %>
      <% end %>
    -->
    
    </td>

    <td>

      <%= link_to 'Deny', deny_waiver_path(waiver), method: :post %><br />
      <%= link_to 'Approve', approve_waiver_path(waiver), method: :post %></td>

  </tr>
<% end %>
</table>

<% if user_signed_in? %>
  <%= link_to 'Back', courses_path %> <br />
  <%= link_to('Instructor Logout', destroy_user_session_path, method: :delete) %>
<% end %>
<br />

<% if admin_signed_in? %>
  <%= link_to 'Edit Course', edit_course_path(@course) %> <br />
  <%= link_to 'Back', courses_path %> <br />
  <%= link_to "Administrator Dashboard", admin_path %> <br />
  <%= link_to('Admin Logout', destroy_admin_session_path, method: :delete) %>
<% end %>